dist: focal
os: linux
arch:
  - amd64
  - arm64
language: node_js
node_js:
  - 14

cache:
  yarn: true
  directories:
    - $HOME/.cache/electron
    - $HOME/.cache/electron-builder
    - $HOME/.npm/_prebuilds

before_install:
  - git clone --depth=1 https://github.com/raspberrypi/tools.git /tmp/tools
  - export PATH=/tmp/tools/arm-bcm2708/arm-linux-gnueabihf/bin:$PATH

# before_install:
# - sudo apt install snapd
# - sudo snap install snapcraft --classic
# - sudo snap install multipass --candidate
addons:
  apt:
    update: true

script:
  - yarn package
  - yarn dist

deploy:
  provider: snap
  snap: dist/ozone-display*.snap
  channel: edge
